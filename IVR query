Query used to pull IVR events from the entire query:

SELECT
EVENT_DATE_GMT,
MDN,
EMIN,
IMEI,
IMSI,
RECORD_TYPE,
EVENT_ID,
EVENT_TYPE,
EVENT_NAME,
EVENT_LOCATION,
EVENT_DETAILS,
SERVICE_IMPACTED,
SERVICE_TYPE,
START_DATE,
RES_DATE RESOLVED_DATE,
CASE WHEN RES_DATE IS NULL THEN 'Not Resolved' ELSE 'Resolved' END RESOLVED_CATEGORY,
SEVERITY,
DATA_SOURCE,
'Network Event' EVENT_CATEGORY,
CUSTOMER_IMPACTED_TIME_INTERVALS,
OUTAGE_CUSTOMER_STATUS,
OUTAGE_CUSTOMER_LOCATION,
EVENT_DURATION
FROM (
SELECT
DAT.*,
ROW_NUMBER() OVER(PARTITION BY MDN,EVENT_ID ORDER BY DATA_SOURCE,LOAD_TIME DESC) RN
FROM
(
SELECT MDNN.EVENT_DATE_GMT,MDNN.MDN,MDNN.EMIN,MDNN.IMEI,MDNN.IMSI,MDNN.RECORD_TYPE,MDNN.EVENT_ID,MDNN.EVENT_TYPE,EVENT.EVENT_NAME,
EVENT.EVENT_LOCATION,EVENT.EVENT_DETAILS,MDNN.SERVICE_IMPACTED,MDNN.SERVICE_TYPE,MDNN.START_DATE,EVENT.RES_DATE,
MDNN.SEVERITY,MDNN.DATA_SOURCE,MDNN.CUSTOMER_IMPACTED_TIME_INTERVALS,MDNN.OUTAGE_CUSTOMER_STATUS,MDNN.OUTAGE_CUSTOMER_LOCATION,MDNN.EVENT_DURATION,MDNN.EVENT_DAY,EVENT.CREATE_DATE,MDNN.LOAD_TIME FROM 
(SELECT * FROM ${hiveconf:DATABASE_NAME}.STP_CUSTOMER_EVENT_HISTORY_IVR WHERE EVENT_DAY >= ${hiveconf:FILTER} AND MDN IS NOT NULL) MDNN,
( SELECT EVENT_ID,MAX(EVENT_NAME) EVENT_NAME,MAX(EVENT_LOCATION) EVENT_LOCATION,MAX(EVENT_DETAILS) EVENT_DETAILS,MAX(RESOLVED_DATE) RES_DATE,
  MAX(CREATE_DATE) CREATE_DATE FROM ${hiveconf:DATABASE_NAME}.STP_CUSTOMER_EVENT_HISTORY_IVR 
  WHERE EVENT_DAY >= ${hiveconf:FILTER} AND UPPER(EVENT_NAME) NOT LIKE '%TEST%' GROUP BY EVENT_ID ) EVENT
WHERE MDNN.EVENT_ID = EVENT.EVENT_ID
) DAT
)EVENT_DATA WHERE RN=1
